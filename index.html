<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>3D Car Simulator</title>
  <style>
    body { margin:0; overflow:hidden; background:#101418; }
    #hud {
      position:absolute; top:12px; left:12px; color:#e8f0ff; font-family:sans-serif;
      background:rgba(0,0,0,0.35); padding:8px 12px; border-radius:8px; z-index:10;
    }
    #joystick {
      position:absolute; bottom:40px; left:40px; width:120px; height:120px;
      background:rgba(255,255,255,0.1); border:2px solid #aaa; border-radius:50%;
      touch-action:none; z-index:20;
    }
    #stick {
      position:absolute; width:60px; height:60px; background:rgba(255,255,255,0.4);
      border-radius:50%; left:30px; top:30px;
    }
  </style>
</head>
<body>
  <div id="hud">Speed: <span id="speed">0</span> km/h</div>
  <div id="joystick"><div id="stick"></div></div>

  <script src="https://unpkg.com/three@0.160.0/build/three.min.js"></script>
  <script>
    // Renderer
    const renderer = new THREE.WebGLRenderer({antialias:true});
    renderer.setSize(window.innerWidth, window.innerHeight);
    document.body.appendChild(renderer.domElement);

    // Scene & camera
    const scene = new THREE.Scene();
    const camera = new THREE.PerspectiveCamera(70, window.innerWidth/window.innerHeight, 0.1, 2000);
    camera.position.set(0,5,15);
    camera.lookAt(0,0,0);

    // Lights
    const hemi = new THREE.HemisphereLight(0xffffff,0x202020,0.9);
    scene.add(hemi);
    const dir = new THREE.DirectionalLight(0xffffff,0.8);
    dir.position.set(10,20,10);
    scene.add(dir);

    // Sky
    const sky = new THREE.Mesh(new THREE.SphereGeometry(1000,32,32),
      new THREE.MeshBasicMaterial({color:0x87ceeb, side:THREE.BackSide}));
    scene.add(sky);
    const sun = new THREE.Mesh(new THREE.SphereGeometry(30,32,32),
      new THREE.MeshBasicMaterial({color:0xffd700}));
    sun.position.set(200,300,-400);
    scene.add(sun);

    // Road
    const road = new THREE.Mesh(new THREE.PlaneGeometry(2000,20),
      new THREE.MeshStandardMaterial({color:0x333333}));
    road.rotation.x = -Math.PI/2;
    scene.add(road);

    // Lane markings
    const laneMat = new THREE.MeshBasicMaterial({color:0xffffff});
    for(let i=-2;i<=2;i++){
      const lane = new THREE.Mesh(new THREE.PlaneGeometry(2000,0.2), laneMat);
      lane.rotation.x = -Math.PI/2;
      lane.position.z = i*4;
      lane.position.y = 0.01;
      scene.add(lane);
    }

    // Player car
    function buildCar(color=0x3a8cff){
      const car = new THREE.Group();
      const body = new THREE.Mesh(new THREE.BoxGeometry(3.6,1.2,1.6),
        new THREE.MeshStandardMaterial({color}));
      body.position.y=0.8;
      car.add(body);
      // rear bumper
      const bumper = new THREE.Mesh(new THREE.BoxGeometry(3.6,0.4,0.2),
        new THREE.MeshStandardMaterial({color:0x222222}));
      bumper.position.set(0,0.4,-0.9);
      car.add(bumper);
      return car;
    }
    const player = buildCar();
    scene.add(player);

    // Traffic cars
    function buildTraffic(x,z,color){
      const car = buildCar(color);
      car.position.set(x,0,z);
      scene.add(car);
      return car;
    }
    const traffic = [
      buildTraffic(20,4,0xff0000),
      buildTraffic(-20,-4,0x00ff00)
    ];

    // Controls
    let speed=0;
    const speedEl=document.getElementById('speed');
    function animate(){
      requestAnimationFrame(animate);
      player.position.x += speed*0.01;
      camera.position.set(player.position.x-8,4,player.position.z+15);
      camera.lookAt(player.position);
      speedEl.textContent=Math.round(speed*3.6);
      renderer.render(scene,camera);
    }
    animate();

    // Keyboard
    window.addEventListener('keydown',e=>{
      if(e.code==="ArrowUp") speed=10;
      if(e.code==="ArrowDown") speed=-5;
      if(e.code==="KeyR"){player.position.set(0,0,0);speed=0;}
    });
    window.addEventListener('keyup',e=>{
      if(e.code==="ArrowUp"||e.code==="ArrowDown") speed=0;
    });
  </script>
</body>
</html>
